READ_OBJECT	LDA     file_num		; Get file number to read from	STA     cont_blk+9 		; Save number in control block	LDA	#8			; Set A = 8 (Read objects OSGBPB)	JSR	SETUP_OSGBPB_BLOCK	; Do control block and OSGBPB call	LDA	cont_blk+9		; Which file to ask for next	STA	file_num		; Save value for next read object	LDY     param_blk		; Load length of filename to Y:rd_obj_lp	LDA     param_blk,Y		; A = ASC value of object name	CMP	#32			; If A > 32 then found and of	BPL     :end_rd_obj_lp		; Object name.	DEY				; If not then dec Y and redue.	JMP     :rd_obj_lp:end_rd_obj_lp	INY	LDA	#&FF			; Terminating value used by my:save_terminator	STA     param_blk,Y		; print routine.	LDA     cont_blk+5 		; Number of files not transferred	RTSPRINT_OBJECT	JSR     OBJECT_TYPE 	STA     key_press		; Save this value for later	CMP	#02                   	BNE     :now_print_object      ; If directory print inverted	JSR     INVERSE_COLOUR:now_print_object                      ; Print Key Value for object	JSR     STORE_ASCII_VALUE 	JSR     OSWRCH 	LDA	#")" 	JSR     OSWRCH 	LDA	#32 	JSR     OSWRCH	LDX	#>object_name		; Print object name	LDY	#<object_name	JSR     PRINT_TEXT	JSR     DEFAULT_COLOUR	LDA	util_store	CMP	#"D"	BNE	:not_display_exit	JMP     :unknown_filetype:not_display_exit	LDA	#31                    ; Set up text position for	JSR     OSWRCH                 ; object information	LDA     text_pos 	CLC	ADC	#16	JSR     OSWRCH	LDA     text_pos+1 	JSR     OSWRCH;	0	Indicates no such file 		(Should never be 0);	1	Indicates file exists but of unknown type;	2	Indicates object is directory;	3	This is a BASIC file/Program;	4	This is a ROM file/image	(No load facility);	5	This is a VIEW file;	6	This is a WORDWISE file	;	7	This is a AMPLE file		(No load facility);	8	This is a Folio file		(Entry, No load facility)	LDA     key_press		; = value from OBJECT_TYPE call.	JSR	FIND_FILE_TYPE		; OBJECT_TYPE must be called first	CMP	#02			; Is object Directory?	BNE     :not_display_directory_type	LDX	#>directory_object_text	LDY	#<directory_object_text	JSR     PRINT_TEXT	JMP     :unknown_filetype:not_display_directory_type			CMP	#06			; & A must contain value returned	BNE	:not_display_wordwise_type	LDX	#>wordwise_text	LDY	#<wordwise_text	JSR	PRINT_TEXT		JMP	:unknown_filetype:not_display_wordwise_type	CMP	#01	BEQ	:unknown_filetype	CMP	#05	BNE	:not_display_view_type       LDX	#>viewfile_text       LDY	#<viewfile_text       JSR	PRINT_TEXT	JMP	:unknown_filetype:not_display_view_type	CMP	#04	BNE	:not_display_rom_type	JSR	SHADED_COLOUR	LDX	#>rom_image_text	; It is a Rom Image ?????	LDY	#<rom_image_text       JSR     PRINT_TEXT	JSR	DEFAULT_COLOUR	JMP	:unknown_filetype:not_display_rom_type	CMP	#08	BNE	:not_display_folio_type	LDX	#>folio_text	LDY	#<folio_text	JSR	PRINT_TEXT	JMP	:unknown_filetype:not_display_folio_type	CMP	#07	BNE	:not_display_ample_type	JSR	SHADED_COLOUR	LDX	#>ample_text	LDY	#<ample_text       JSR     PRINT_TEXT		JSR	DEFAULT_COLOUR	JMP	:unknown_filetype:not_display_ample_type	CMP	#03	BNE	:unknown_filetype       LDX	#>basic_file_text	LDY	#<basic_file_text       JSR     PRINT_TEXT:unknown_filetype			; Workout next text position       INC     text_pos+1        LDA     text_pos+1        CMP	#14       BNE     :not_indent		; Have 13 objects benn printed       LDA	#40			; Indent text position and then       STA     text_pos		; reset line number        LDA	#01        STA     text_pos+1:not_indent                            ; Position text cursur for next       LDA	#31			; object       JSR     OSWRCH        LDA     text_pos        JSR     OSWRCH       LDA     text_pos+1        JSR     OSWRCH        RTSOBJECT_TYPE	LDX	#>param_blk	LDY	#<param_blk	INX	STX     text_add 	STY     text_add+1 	LDY	#0:relocate_param_object	LDA     (text_add),Y 	CMP	#&FF	BEQ     :do_object_check	STA     object_name,Y 	STA	name_store,Y	INY	JMP     :relocate_param_object:do_object_check	LDA	#13	STA     object_name,Y 	LDA	#&FF	STA	name_store,Y	TYA	PHA	STA     Temp+1	LDX	#>object_name	LDY	#<object_name	STX     cont_blk 	STY     cont_blk+1	LDX	#>cont_blk	LDY	#<cont_blk	LDA	#5	JSR     OSFILE	STA     Temp			; Store object type temporarily 	PLA	TAY	INY	LDA	#&FF	STA     object_name,Y	LDA	#02	CMP	Temp	BEQ	:skip_address_store	LDX	#0	LDY	#02:address_transfer	LDA     cont_blk,Y		; Store file load address	STA     load_address,X		; for file reference later 	INY	INX	CPY	#15	BNE	:address_transfer:skip_address_store	LDA	cont_blk+&0E	STA	attributes	LDA     Temp 	RTSNO_OBJECTS	LDA	#0	CMP	util_store	BEQ	:normal_no_objects	LDA	#"D"	CMP	util_store	BNE	:not_display_no_obj		LDA	#0	STA	data_buffer	JMP	:not_up_directory:not_display_no_obj		LDA	#27	STA	key_press	LDA	#139	JSR	GO_BACKUP_DIRECTORY	JMP	:not_up_directory:normal_no_objects	LDA	#12	JSR     OSWRCH	JSR	OPT_WINDOW       LDX	#>no_objects_text       LDY	#<no_objects_text       JSR     PRINT_TEXT	LDA	#139	STA	key_storage	LDA	#27	STA	key_storage+1	LDA	#"1"	STA	key_storage+2	LDA	#3	STA	num_keys	LDX	#01	JSR	CHECK_KEYS	LDA	key_press       CMP	#"1"        BNE     :not_newfile       JSR	PREP_NEW_FILE	JMP	:not_up_directory:not_newfile       CMP	#139       BEQ     :not_up_directory	JSR	GO_BACKUP_DIRECTORY:not_up_directory       RTSCHECK_FOR_WORDWISE_FILE	LDA	#234	LDX	#0	LDY	#&FF	JSR	OSBYTE			; Test for 2nd Processor active	CPX	#&FF			; If is then check 0000 else FFFF	BNE	:not_wordwise_zero	LDY	#0:test_zero_loop	LDA	load_address,Y	CMP	#0	BNE	:not_wordwise	INY	CPY	#07	BNE	:test_zero_loop	LDA	#&06	RTS:not_wordwise_zero	LDY	#0:test_ff_loop	LDA	load_address,Y	CMP	#&FF	BNE	:not_wordwise	INY	CPY	#07	BNE	:test_ff_loop	LDA	#&06	RTS:not_wordwise	LDA	#00	RTSFIND_FILE_TYPE				; A contains OBJECT_TYPE result!	CMP	#02			; Is object Directory?	BNE     :now_check_for_filetypes	JMP	:exit_file_type_find	:now_check_for_filetypes	JSR	CHECK_FOR_WORDWISE_FILE	CMP	#06	BNE	:now_check_for_view	JMP	:exit_file_type_find:now_check_for_view	LDA	load_address			CMP	#&2E			; Check for View type 2E0D Part 1	BEQ	:maybe_view_type	CMP	#&56			; Check for View type 5645 Part 1	BEQ	:maybe_view_type	CMP	#&76			; Check for View type 7665 Part 1	BEQ	:maybe_view_type	CMP	#&65			; Check for View type 650D Part 1	BEQ	:maybe_view_type	JMP	:not_view_file:maybe_view_type			; Check for second part	LDA	load_address+1	CMP	#&0D			; Check for View type 2E0D Part 2	BEQ	:view_file_for_sure	CMP	#&45			; Check for View type 5645 Part 2	BEQ	:view_file_for_sure	CMP	#&65			; Check for View type 7665 Part 2	BEQ	:view_file_for_sure	CMP	#&0D			; Check for View type 650D Part 2	BEQ	:view_file_for_sure	CMP	#&76			; Check for View type 6576 Part 2	BEQ	:view_file_for_sure       JMP	:not_view_file:view_file_for_sure	LDA	#05	JMP	:exit_file_type_find:not_view_file				; Check file for Rom Image	LDA	load_address+1	CMP	#&80          		; Check ROM type 8000 Part 1       BNE     :not_rom_image		; Load Address only	LDA	load_address		; Check ROM type 8000 Part 2	BNE	:not_rom_image		; Load Address Only	LDA	exec_address+1		; Check ROM exec 8000 Part 1	CMP	#&80	BNE	:not_rom_image	LDA	exec_address		; Check ROM exec+1 8000 Part 2	BNE	:not_rom_image	LDA	#04	JMP	:exit_file_type_find:not_rom_image				; Check for Ample file	LDA     exec_address		; Execute address FFFF0100	BNE	:not_ample_file	LDA	exec_address+1	CMP	#01	BNE     :not_ample_file	LDA	exec_address+2	CMP	#&FF	BNE	:not_ample_file	LDA	exec_address+3	CMP	#&FF	BNE	:not_ample_file	LDA	#07	JMP	:exit_file_type_find:not_ample_file			LDA	exec_address+1		; Check for Folio file	CMP	#&FA			; Check for &FA of FACE	BNE	:not_folio_file	LDA	exec_address	CMP	#&CE			; Check for &CA of FACE	BNE	:not_folio_file	LDA	#08			; Set to 8 for Folio file	JMP	:exit_file_type_find:not_folio_file				LDA     exec_address+1		; Check for Basic Program	CMP	#&80	BNE	:file_type_unknown	LDA	exec_address	CMP	#&23			; Check for 1st type BASIC code	BEQ	:yes_it_is_basic_as_we_know_it	CMP	#&2B			; Check for 2nd type BASIC code	BNE	:file_type_unknown	:yes_it_is_basic_as_we_know_it	LDA	#03	JMP	:exit_file_type_find:file_type_unknown	LDA	#01:exit_file_type_find	RTS