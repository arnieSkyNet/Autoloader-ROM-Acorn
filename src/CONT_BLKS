Å..........*.......*.......*......*.......*.......*.......*.......*.......*.<GET_FS_PS_NUMBER        STA	cont_blk	LDA	#&13	LDX	#>cont_blk		LDY	#<cont_blk	JSR	OSWORD	RTSWRITE_PROTECTION	STA	cont_blk+1	LDA	#05	STA	cont_blk	LDA	#&13	LDX	#>cont_blk		LDY	#<cont_blk	JSR	OSWORD	RTSREAD_PROTECTION	LDA	#04	STA	cont_blk	LDA	#&13	LDX	#>cont_blk		LDY	#<cont_blk	JSR	OSWORD	LDA	cont_blk+1	RTSGET_STATION_NUMBER	LDA	#08	STA	cont_blk	LDA	#&13	LDX	#>cont_blk		LDY	#<cont_blk	JSR	OSWORD	RTS	SETUP_OSGBPB_BLOCK	PHA				; Stack OSGBPB type command        LDA	#0			; Set A to 0 to for control block	STA	cont_blk		; Set block?0 to 0	STA	cont_blk+6		; Set block?6 to 0	STA	cont_blk+7		; Set block?7 to 0	STA	cont_blk+8		; Set block?8 to 0        LDX	#>param_blk		; Low address of data buffer        LDY	#<param_blk		; High address of data buffer        STX     cont_blk+1 		; Store Low byte buffer address        STY     cont_blk+2 		; Store high byte buffer address        LDA	#&FF			; 2nd processor address        STA     cont_blk+3 		; to be saved incase 2nd processor        STA     cont_blk+4		; is active.        LDA	#01			; Number of files to read        STA     cont_blk+5		; Save number of files to read        LDX	#>cont_blk		; Low address of control block        LDY	#<cont_blk		; High address of contol block	PLA				; Unstack OSGBPB command type	JSR     UTILITY_OSGBPB_COMMAND	; Call error trapping OSGBPB        RTSREAD_DISC_TITLE	LDA	#5	JSR	SETUP_OSGBPB_BLOCK	LDA	param_blk	STA	Temp	INC	Temp	LDA	curr_file_syst	CMP	#05	BNE	:not_net_print_block	LDA	#11	STA	Temp:not_net_print_block	LDY	#1	LDA	util_store	CMP	#"G"	BNE	:not_get_title_util	LDX	file_num	BNE	:back_into_main_title	STY	file_num+1	JSR	MOVE_DATA_INTO_BUFFER	JMP	:back_into_main_title:not_get_title_util	JSR	PRINT_BLOCK_NAME:back_into_main_title	RTSREAD_CSD_NAME	LDA	#6	JSR	SETUP_OSGBPB_BLOCK		LDA	param_blk+2	STA	Temp        INC	Temp	INC	Temp	INC	Temp	LDA	param_blk        STA	tape_flag	LDA	param_blk+1	STA	isdata_flag	LDA	curr_file_syst	CMP	#05	BEQ	:set_to_two	LDY	#03	JMP	:do_print_csd_block:set_to_two	LDY	#02:do_print_csd_block	STY	file_num+1	LDA	util_store	CMP	#"G"	BNE	:not_get_util	LDX	file_num	BNE	:back_into_main_csd	JSR	MOVE_DATA_INTO_BUFFER	JMP	:back_into_main_csd:not_get_util	JSR	PRINT_BLOCK_NAME:back_into_main_csd	LDA	isdata_flag	STA	Temp+1	LDA	tape_flag	STA	Temp	RTSMOVE_DATA_INTO_BUFFER	LDA	param_blk,Y	STA	data_buffer,X	INY	INX	CMP	#&FF	BEQ	:exit_mover	CMP	#13	BEQ	:no_return_store	CMP	#32	BEQ	:exit_mover	CMP	#0	BEQ	:exit_mover	CMP	#126	BPL	:exit_mover	JMP	MOVE_DATA_INTO_BUFFER:exit_mover	LDA	#13	DEX	STA	data_buffer,X:no_return_store	STX	file_num	RTSACCESS_FILE	LDX	#>object_name	LDY	#<object_name	STX	cont_blk	STY	cont_blk+1	STA	cont_blk+14	LDA	#04	LDX	#>cont_blk	LDY	#<cont_blk	JSR	UTILITY_OSFILE_COMMAND        RTSGET_MACHINE_TYPE	LDA	#0			; Get current machine type	LDX	#&40	JSR	OSBYTE	STX	machine_type		; Store machine type for later use	TXA				; Put mac type in A for get codes	RTSFILING_SYSTEM	LDA	#0			; Read current filing system	LDX	#0	LDY	#0	JSR	OSARGS	STA	curr_file_syst		; Store CFS for further use	RTSREAD_CURRENT_USER	JSR	CLEAR_CONTROL_BLOCK	LDA	#09			; Set size of control block	STA	cont_blk+1	LDA	#15			; Set function code for call	STA	cont_blk+3	LDA	cfs_tran+1		; Start entry stored previously	STA	cont_blk+7		LDA	#01			; Get one entry	STA	cont_blk+8	LDX	#>cont_blk	LDY	#<cont_blk	LDA	#&14	JSR	OSWORD	LDA	cont_blk+3		; Get return code	CMP	#0	BEQ	:no_user_read_error	BRK	BRK	BRK:no_user_read_error	LDA	cont_blk+5		; Users station number	CMP	cfs_tran		; Compare with local station number	BEQ	:got_users_name	INC	cfs_tran+1	JMP	READ_CURRENT_USER:got_users_name	LDX	#>cont_blk+7	LDY	#<cont_blk+7	JSR	MOVE_DOWN_MEMORY	RTS